{% extends "base.html" %}

{% block head_extra %}

<!-- HTMX -->
<!-- https://htmx.org/ -->
<script src="https://unpkg.com/htmx.org@2.0.4" integrity="sha384-HGfztofotfshcF7+8n44JQL2oJmowVChPTg48S+jvZoztPfvwD79OC/LTtG6dMp+" crossorigin="anonymous"></script>


<!-- Extra CSS for Tabs -->
<style>
    .tabcontent {
        display: none;
    }

    .tabcontent.is-active {
        display: block;
    }
</style>

{% endblock %}

{% block main %}
<section class="section">
    <p class="title">
        {{ dataset.title }}
    </p>

    <p class="subtitle">
        {% if dataset.author %}
        {% for author in dataset.author %}
        {{ author.name }}{% if not loop.last %}; {% endif %}
        {% endfor %}
        {% else %}
        N/A
        {% endif %}
    </p>

    <div class="content">
        <p class="title is-5">General information</p>
        <ul>
            <li>Origin: {{ dataset.origin.name if dataset.origin else 'N/A' }}</li>
            <li>ID in origin: {{ dataset.id_in_origin }}</li>
            <li>Licence: {{ dataset.license }}</li>
            <li>DOI: <a href="https://doi.org/{{ dataset.doi }}" target="_blank">{{ dataset.doi }}</a></li>
            <li>URL: <a href="{{ dataset.url }}" target="_blank">{{ dataset.url }}</a></li>
        </ul>
    </div>
    <div class="content">
        <p class="title is-5">Description</p>
        <p>{{ dataset.description }}</p>
    </div>


    <p class="title is-5">Keywords</p>
    <p>{% if dataset.keyword %}
        {% for keyword in dataset.keyword %}
        <span class="tag">{{ keyword.entry }} </span>
        {% endfor %}
        {% else %}
        N/A
        {% endif %}
    </p>
    </div>

    <hr class="bd-hr">


    <div class="tabs is-toggle is-fullwidth">
        <ul>
            <li class="is-active" id="tablinks" hx-trigger="click" hx-get="/dataset/{{ dataset.dataset_id }}/files/all_files" hx-swap="innerHTML" hx-target="#all_files_tables_for_specific_dataset">
                <a onclick="openTab(event, 'all_files')">All files</a>
            </li>
            <li id="tablinks">
                <a onclick="openTab(event, 'top_files')">Topology files</a>
            </li>
            <li id="tablinks">
                <a onclick="openTab(event, 'param_files')">Parameter files</a>
            </li>
            <li id="tablinks">
                <a onclick="openTab(event, 'traj_files')">Trajectory files</a>
            </li>
        </ul>
    </div>

    <div>
        <ul>
            <li class="tabcontent is-active" id="all_files">
                <h3 class="title is-spaced">Table containing all the files associated with the dataset</h3>
                <table id="all_files_tables_for_specific_dataset">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Size</th>
                            <th>URL</th>
                            <th>Is from zip file ?</th>
                        </tr>
                    </thead>

                    <tbody>
                        {% for file in files %}
                        <tr>
                            <td>{{ file.name }}</td>
                            <td>{{ file.type }}</td>
                            <td>{{ file.size }}</td>
                            <td><a href="{{ file.url }}" target="_blank">üåê</a></td>
                            <td>{{ file.is_from_zip }}</td>
                        </tr>
                        {% endfor %}
                </table>
            </li>
            <li class="tabcontent" id="top_files">
                <h3 class="title is-spaced">Table with all the topology files associated with the dataset</h3>
                <table id="top_files_tables_for_specific_dataset">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Size</th>
                            <th>URL</th>
                            <th>Is from zip file ?</th>
                        </tr>
                    </thead>

                    <tbody>
                        {% for file in files %}
                        <tr>
                            <td>{{ file.name }}</td>
                            <td>{{ file.type }}</td>
                            <td>{{ file.size }}</td>
                            <td><a href="{{ file.url }}" target="_blank">üåê</a></td>
                            <td>{{ file.is_from_zip }}</td>
                        </tr>
                        {% endfor %}
                </table>
            </li>
            <li class="tabcontent" id="param_files">
                <h3 class="title is-spaced">Table with all the parameter files associated with the dataset</h3>
                <table id="param_files_tables_for_specific_dataset">

                </table>
            </li>
            <li class="tabcontent" id="traj_files">
                <h3 class="title is-spaced">Table with all the trajectory files associated with the dataset</h3>
                <table id="traj_files_tables_for_specific_dataset">

                </table>
            </li>
        </ul>
    </div>


</section>

{% endblock %}

{% block script_extra %}

<script>
    function openTab(evt, tabTitle) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" is-active", "");
        }
        document.getElementById(tabTitle).style.display = "block";
        evt.currentTarget.className += " is-active";
    }

    $(document).ready(function() {
        $('#all_files_tables_for_specific_dataset').DataTable({
            "order": [
                [1, 'desc']
            ],
            autoWidth: false,
            orderClasses: false,

        });
    });

    $(document).ready(function() {
        $('#top_files_tables_for_specific_dataset').DataTable({
            "order": [
                [1, 'desc']
            ],
            autoWidth: false,
            orderClasses: false,

        });
    });

</script>

{% endblock %}